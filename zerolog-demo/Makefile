APP_NAME := zerolog-demo
VERSION := v1.0.0
BUILD_DIR := ./bin

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GREEN := \033[32m
YELLOW := \033[33m
CYAN := \033[36m
RED := \033[31m
NC := \033[0m

.PHONY: help build clean run-all test-levels test-formats

# –ü–æ–º–æ—â—å
help: ## –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–º–æ—â–∏
	@echo "$(CYAN)$(APP_NAME) - Zerolog Demo$(NC)"
	@echo ""
	@echo "$(YELLOW)–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:$(NC)"
	@awk 'BEGIN {FS = ":.*##"} /^[a-zA-Z_-]+:.*##/ {printf "  $(GREEN)%-15s$(NC) %s\n", $$1, $$2}' $(MAKEFILE_LIST)

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
deps: ## –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
	@echo "$(YELLOW)–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...$(NC)"
	go mod download
	go mod tidy

# –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
build: deps ## –°–æ–±—Ä–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
	@echo "$(YELLOW)–°–±–æ—Ä–∫–∞ $(APP_NAME)...$(NC)"
	@mkdir -p $(BUILD_DIR)
	go build -ldflags "-X main.version=$(VERSION)" -o $(BUILD_DIR)/$(APP_NAME) .
	@echo "$(GREEN)‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: $(BUILD_DIR)/$(APP_NAME)$(NC)"

# –û—á–∏—Å—Ç–∫–∞
clean: ## –û—á–∏—Å—Ç–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–±–æ—Ä–∫–∏
	@echo "$(YELLOW)–û—á–∏—Å—Ç–∫–∞...$(NC)"
	rm -rf $(BUILD_DIR)
	go clean -cache

# –ó–∞–ø—É—Å–∫ —Å —Ä–∞–∑–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏
run-all: build ## –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–º–æ —Å–æ –≤—Å–µ–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
	@echo "$(CYAN)üéØ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —É—Ä–æ–≤–Ω–µ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è$(NC)"
	@echo ""
	@echo "$(YELLOW)1. TRACE —É—Ä–æ–≤–µ–Ω—å (—Å–∞–º—ã–π –¥–µ—Ç–∞–ª—å–Ω—ã–π):$(NC)"
	@$(BUILD_DIR)/$(APP_NAME) --log-level=trace --prettify
	@echo ""
	@echo "$(YELLOW)2. DEBUG —É—Ä–æ–≤–µ–Ω—å:$(NC)"
	@$(BUILD_DIR)/$(APP_NAME) --log-level=debug --prettify
	@echo ""
	@echo "$(YELLOW)3. INFO —É—Ä–æ–≤–µ–Ω—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):$(NC)"
	@$(BUILD_DIR)/$(APP_NAME) --log-level=info --prettify
	@echo ""
	@echo "$(YELLOW)4. WARN —É—Ä–æ–≤–µ–Ω—å:$(NC)"
	@$(BUILD_DIR)/$(APP_NAME) --log-level=warn --prettify
	@echo ""
	@echo "$(YELLOW)5. ERROR —É—Ä–æ–≤–µ–Ω—å (—Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏):$(NC)"
	@$(BUILD_DIR)/$(APP_NAME) --log-level=error --prettify

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π
test-levels: build ## –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
	@echo "$(CYAN)üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è$(NC)"
	@echo ""
	@for level in trace debug info warn error; do \
		echo "$(YELLOW)–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è: $$level$(NC)"; \
		$(BUILD_DIR)/$(APP_NAME) --log-level=$$level --prettify; \
		echo ""; \
	done

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤
test-formats: build ## –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç—ã –≤—ã–≤–æ–¥–∞
	@echo "$(CYAN)üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –≤—ã–≤–æ–¥–∞$(NC)"
	@echo ""
	@echo "$(YELLOW)1. –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å —Ü–≤–µ—Ç–∞–º–∏:$(NC)"
	@$(BUILD_DIR)/$(APP_NAME) --log-format=console --prettify
	@echo ""
	@echo "$(YELLOW)2. –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –±–µ–∑ —Ü–≤–µ—Ç–æ–≤:$(NC)"
	@$(BUILD_DIR)/$(APP_NAME) --log-format=console
	@echo ""
	@echo "$(YELLOW)3. JSON —Ñ–æ—Ä–º–∞—Ç:$(NC)"
	@$(BUILD_DIR)/$(APP_NAME) --log-format=json

# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
demo: build ## –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é
	@echo "$(CYAN)üöÄ –ü–æ–ª–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è zerolog$(NC)"
	@echo ""
	@echo "$(YELLOW)–ó–∞–ø—É—Å–∫ —Å –∫—Ä–∞—Å–∏–≤—ã–º –∫–æ–Ω—Å–æ–ª—å–Ω—ã–º –≤—ã–≤–æ–¥–æ–º:$(NC)"
	@$(BUILD_DIR)/$(APP_NAME) --log-level=debug --prettify

# –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
examples: build ## –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
	@echo "$(CYAN)üìñ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è$(NC)"
	@echo ""
	@echo "$(YELLOW)–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:$(NC)"
	@echo "  $(BUILD_DIR)/$(APP_NAME) --log-level=trace"
	@echo "  $(BUILD_DIR)/$(APP_NAME) --log-level=debug --prettify"
	@echo "  $(BUILD_DIR)/$(APP_NAME) --log-format=json"
	@echo ""
	@echo "$(YELLOW)–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:$(NC)"
	@echo "  trace - –°–∞–º–∞—è –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"
	@echo "  debug - –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"
	@echo "  info  - –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)"
	@echo "  warn  - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è"
	@echo "  error - –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏"
	@echo ""
	@echo "$(YELLOW)–§–æ—Ä–º–∞—Ç—ã –≤—ã–≤–æ–¥–∞:$(NC)"
	@echo "  console - –ß–∏—Ç–∞–µ–º—ã–π –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç"
	@echo "  json    - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON"
	@echo ""
	@echo "$(YELLOW)–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏:$(NC)"
	@echo "  --prettify - –ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Å —Ü–≤–µ—Ç–∞–º–∏"
